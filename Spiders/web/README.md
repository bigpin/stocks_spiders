# 股票信号分析系统 Web 客户端

用于展示股票信号分析结果的 Web 应用，提供数据可视化、筛选分析和收益计算功能。

## 功能特性

### 数据展示
- 📊 **统计信息面板**：显示总信号数、总股票数、平均成功率、平均最高涨幅
- 📈 **时间轴视图**：可视化展示股票买入点和卖出点的时间线
- 📋 **列表视图**：表格形式展示所有股票信号，支持排序和分页

### 筛选功能
- 🔍 **多条件筛选**：
  - 日期区间（最近7天、14天、一个月等）
  - 股票代码（下拉选择）
  - 买入价格范围
  - 跟踪天数范围
  - 最高涨幅范围
  - 买入当天涨跌范围（滑块调节）
  - 第二天涨跌范围（滑块调节）
  - 置信百分比

### 收益分析
- 💰 **止盈止损收益矩阵**：
  - 动态计算不同止盈止损组合的收益
  - 支持 2% 步长的参数调整
  - 高亮显示最佳和最差结果
  - 可信度标记（达到目标的股票占比）
  - 详细股票列表工具提示

### 时间轴功能
- 📅 **时间轴可视化**：
  - 垂直时间轴展示股票信号
  - 买入点颜色根据买入当天和第二天涨跌显示
  - 鼠标滚轮缩放时间间距
  - Ctrl + 滚轮缩放，普通滚轮滚动
  - 点击选中/取消选中股票
  - 鼠标悬停显示详细信息

## 安装依赖

```bash
pip install -r requirements.txt
```

依赖包：
- Flask
- SQLite3（Python 内置）

## 运行应用

```bash
python app.py
```

应用将在 `http://0.0.0.0:5001` 启动。

然后在浏览器中访问：http://localhost:5001

## 使用说明

### 时间轴视图（默认页面）

1. **筛选股票**：
   - 选择股票代码（下拉选择）
   - 设置日期范围
   - 设置买入价格范围
   - 使用滑块设置买入当天和第二天涨跌范围（需勾选启用）

2. **查看时间轴**：
   - 鼠标滚轮上下滚动时间轴
   - Ctrl + 滚轮缩放时间间距
   - 点击买入点选中/取消选中股票
   - 鼠标悬停查看详细信息

3. **买入点颜色说明**：
   - 🔴 深红色：买入当天上涨 + 第二天上涨
   - 🟢 深绿色：买入当天下跌 + 第二天下跌
   - 🟠 橙色：买入当天上涨 + 第二天下跌
   - 🟢 浅绿色：买入当天下跌 + 第二天上涨
   - 🔴 红色：仅买入当天上涨
   - 🟢 绿色：仅买入当天下跌

### 收益矩阵分析

1. **设置筛选条件**：
   - 日期区间
   - 跟踪天数范围（默认最小10天）
   - 买入价格范围
   - 最高涨幅范围
   - 买入当天/第二天涨跌范围（滑块，需勾选启用）
   - 置信百分比（默认80%）

2. **查看收益矩阵**：
   - 横列为止盈百分比（2% 到 30%）
   - 纵列为止损百分比（-2% 到 -30%）
   - 单元格显示平均收益百分比和触发数量
   - 黄色背景：最佳10个结果
   - 红色背景：最差10个结果
   - 紫色背景：可信度标记（达到目标的股票占比 ≥ 80%）

3. **查看详细信息**：
   - 鼠标悬停在单元格上查看参与计算的股票列表
   - 显示股票代码、名称、持有天数、收益和类型

### 列表视图

访问 http://localhost:5001/list 查看列表视图：

1. **筛选数据**：使用筛选条件区域设置筛选条件，点击"搜索"按钮
2. **排序数据**：点击表头可以按该列排序
3. **分页浏览**：使用底部分页控件浏览更多数据

## API 接口

### 获取信号数据
```
GET /api/signals
参数：
  - stock_code: 股票代码（可选）
  - stock_name: 股票名称（可选）
  - signal_type: 信号类型（可选）
  - min_success_rate: 最小成功率（可选）
  - date_from: 开始日期（可选）
  - date_to: 结束日期（可选）
  - page: 页码（默认1）
  - per_page: 每页数量（默认20）
```

### 获取统计数据
```
GET /api/stats
返回：
  - total_signals: 总信号数
  - total_stocks: 总股票数
  - avg_success_rate: 平均成功率
  - avg_highest_change: 平均最高涨幅
```

### 获取时间轴事件
```
GET /api/calendar/events
参数：
  - stock_code: 股票代码（可选）
  - date_from: 开始日期（可选）
  - date_to: 结束日期（可选）
```

### 获取股票代码列表
```
GET /api/stock-codes
返回所有股票代码和名称列表
```

## 数据库

Web 应用使用项目根目录下的 `stock_signals.db` 数据库。

启动时会自动执行数据库迁移，添加新字段（如 `buy_day_change_rate`、`next_day_change_rate`）。

## 注意事项

1. **端口占用**：默认使用 5001 端口，如果被占用可以修改 `app.py` 中的端口号
2. **数据库路径**：确保数据库文件存在于项目根目录
3. **筛选性能**：大量数据时筛选可能需要一些时间，请耐心等待
4. **浏览器兼容性**：建议使用现代浏览器（Chrome、Firefox、Safari、Edge）

## 技术栈

- **后端**：Flask
- **前端**：HTML5、CSS3、JavaScript（原生）
- **数据库**：SQLite3
- **可视化**：自定义时间轴实现

