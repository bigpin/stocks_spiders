# è‚¡ç¥¨ä¿¡å·åˆ†æç³»ç»Ÿ

åŸºäº Scrapy çš„è‚¡ç¥¨æ•°æ®çˆ¬å–å’ŒæŠ€æœ¯åˆ†æç³»ç»Ÿï¼Œæ”¯æŒ K çº¿æ•°æ®é‡‡é›†ã€æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ã€ä¿¡å·ç”Ÿæˆå’Œå¯è§†åŒ–å±•ç¤ºã€‚

## åŠŸèƒ½ç‰¹æ€§

### æ•°æ®çˆ¬å–
- ğŸ“ˆ **è‚¡ç¥¨ K çº¿æ•°æ®çˆ¬å–**ï¼šä»ä¸œæ–¹è´¢å¯Œè·å–è‚¡ç¥¨å†å² K çº¿æ•°æ®
- ğŸ“Š **æŠ€æœ¯æŒ‡æ ‡è®¡ç®—**ï¼šè‡ªåŠ¨è®¡ç®— KDJã€MACDã€RSIã€å¸ƒæ—å¸¦ç­‰æŠ€æœ¯æŒ‡æ ‡
- ğŸ” **è‚¡ç¥¨åˆ—è¡¨è·å–**ï¼šæ”¯æŒæ‰¹é‡è·å–è‚¡ç¥¨ä»£ç åˆ—è¡¨
- ğŸ’¾ **æ•°æ®å­˜å‚¨**ï¼šä½¿ç”¨ SQLite æ•°æ®åº“å­˜å‚¨è‚¡ç¥¨ä¿¡å·å’Œåˆ†æç»“æœ

### ä¿¡å·åˆ†æ
- ğŸ¯ **KDJ ä¿¡å·è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ« KDJ é‡‘å‰ã€æ­»å‰ç­‰äº¤æ˜“ä¿¡å·
- ğŸ“‰ **ä»·æ ¼æå€¼è¿½è¸ª**ï¼šè¿½è¸ªä¹°å…¥å 30 å¤©å†…çš„æœ€é«˜ä»·å’Œæœ€ä½ä»·
- ğŸ“… **ä¹°å…¥å½“å¤©æ¶¨è·Œè®°å½•**ï¼šè®°å½•ä¹°å…¥å½“å¤©å’Œç¬¬äºŒå¤©çš„æ¶¨è·Œå¹…
- ğŸ“Š **æˆåŠŸç‡ç»Ÿè®¡**ï¼šè®¡ç®—ä¿¡å·çš„æˆåŠŸç‡å’Œæ”¶ç›Šæƒ…å†µ

### Web å¯è§†åŒ–
- ğŸ¨ **ç°ä»£åŒ–ç•Œé¢**ï¼šç¾è§‚çš„ Web ç•Œé¢å±•ç¤ºåˆ†æç»“æœ
- ğŸ“ˆ **æ—¶é—´è½´è§†å›¾**ï¼šå¯è§†åŒ–å±•ç¤ºè‚¡ç¥¨ä¹°å…¥ç‚¹å’Œå–å‡ºç‚¹çš„æ—¶é—´çº¿
- ğŸ” **å¤šæ¡ä»¶ç­›é€‰**ï¼šæ”¯æŒæŒ‰æ—¥æœŸã€è‚¡ç¥¨ä»£ç ã€ä»·æ ¼ã€æ¶¨è·Œå¹…ç­‰æ¡ä»¶ç­›é€‰
- ğŸ“Š **æ”¶ç›ŠçŸ©é˜µåˆ†æ**ï¼šæ­¢ç›ˆæ­¢æŸæ”¶ç›ŠçŸ©é˜µï¼Œæ”¯æŒåŠ¨æ€å‚æ•°è°ƒæ•´
- ğŸ“‰ **ç»Ÿè®¡ä¿¡æ¯**ï¼šæ€»ä½“ç»Ÿè®¡æ•°æ®å±•ç¤º

## é¡¹ç›®ç»“æ„

```
Spiders/
â”œâ”€â”€ spiders/              # Scrapy çˆ¬è™«
â”‚   â”œâ”€â”€ stock_kline.py    # K çº¿æ•°æ®çˆ¬è™«ï¼ˆä¸»è¦ï¼‰
â”‚   â”œâ”€â”€ stock_detail.py   # è‚¡ç¥¨è¯¦æƒ…çˆ¬è™«
â”‚   â”œâ”€â”€ get_stock_list.py # è‚¡ç¥¨åˆ—è¡¨è·å–
â”‚   â”œâ”€â”€ technical_indicators.py  # æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
â”‚   â””â”€â”€ stock_config.py   # è‚¡ç¥¨é…ç½®
â”œâ”€â”€ web/                  # Web åº”ç”¨
â”‚   â”œâ”€â”€ app.py           # Flask åº”ç”¨
â”‚   â”œâ”€â”€ templates/       # HTML æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ calendar.html  # æ—¶é—´è½´è§†å›¾
â”‚   â”‚   â””â”€â”€ index.html     # åˆ—è¡¨è§†å›¾
â”‚   â””â”€â”€ requirements.txt # Python ä¾èµ–
â”œâ”€â”€ run.py               # è¿è¡Œè„šæœ¬
â”œâ”€â”€ settings.py          # Scrapy é…ç½®
â””â”€â”€ stock_signals.db     # SQLite æ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## å®‰è£…ä¾èµ–

### Python ç¯å¢ƒè¦æ±‚
- Python 3.11+

### å®‰è£… Scrapy ç›¸å…³ä¾èµ–

```bash
pip install scrapy scrapy-splash pandas ta sqlite3
```

### å®‰è£… Web åº”ç”¨ä¾èµ–

```bash
cd Spiders/web
pip install -r requirements.txt
```

## ä½¿ç”¨æ–¹æ³•

### 1. çˆ¬å–è‚¡ç¥¨æ•°æ®

#### ä»æ–‡ä»¶è¯»å–è‚¡ç¥¨åˆ—è¡¨

```bash
python Spiders/run.py
```

æˆ–ä½¿ç”¨ Scrapy å‘½ä»¤ï¼š

```bash
cd Spiders
scrapy crawl stock_kline -a use_file=true -a stock_file=../stock_list.txt -a calc_indicators=true
```

#### æŒ‡å®šè‚¡ç¥¨ä»£ç 

```bash
scrapy crawl stock_kline -a stock_codes=sh603288,sz000858 -a calc_indicators=true
```

#### è·å–æ˜¨å¤©çš„æ•°æ®

```python
from Spiders.run import run_stock_kline_spider_with_yesterday
run_stock_kline_spider_with_yesterday('sh603288,sz000858')
```

### 2. è¿è¡Œ Web åº”ç”¨

```bash
cd Spiders/web
python app.py
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://localhost:5001

### 3. æŸ¥çœ‹åˆ†æç»“æœ

- **æ—¶é—´è½´è§†å›¾**ï¼šhttp://localhost:5001/ ï¼ˆé»˜è®¤ï¼‰
- **åˆ—è¡¨è§†å›¾**ï¼šhttp://localhost:5001/list

## æŠ€æœ¯æŒ‡æ ‡è¯´æ˜

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹æŠ€æœ¯æŒ‡æ ‡çš„è®¡ç®—ï¼š

- **KDJ**ï¼šéšæœºæŒ‡æ ‡ï¼ˆ9, 3 å‚æ•°ï¼‰
- **MACD**ï¼šæŒ‡æ•°å¹³æ»‘ç§»åŠ¨å¹³å‡çº¿ï¼ˆ12, 26, 9 å‚æ•°ï¼‰
- **RSI**ï¼šç›¸å¯¹å¼ºå¼±æŒ‡æ ‡ï¼ˆ6, 12, 24 å‘¨æœŸï¼‰
- **å¸ƒæ—å¸¦**ï¼šå¸ƒæ—æ ¼å¸¦ï¼ˆ20, 2 å‚æ•°ï¼‰

## æ•°æ®åº“ç»“æ„

### stock_signals è¡¨

ä¸»è¦å­—æ®µï¼š
- `stock_code`: è‚¡ç¥¨ä»£ç 
- `stock_name`: è‚¡ç¥¨åç§°
- `insert_date`: ä¹°å…¥æ—¥æœŸ
- `insert_price`: ä¹°å…¥ä»·æ ¼
- `highest_price`: 30 å¤©å†…æœ€é«˜ä»·
- `lowest_price`: 30 å¤©å†…æœ€ä½ä»·
- `buy_day_change_rate`: ä¹°å…¥å½“å¤©æ¶¨è·Œå¹…
- `next_day_change_rate`: ç¬¬äºŒå¤©æ¶¨è·Œå¹…
- `overall_success_rate`: æ•´ä½“æˆåŠŸç‡

## é…ç½®è¯´æ˜

### Scrapy é…ç½® (settings.py)

- `SPLASH_URL`: Splash æœåŠ¡åœ°å€ï¼ˆç”¨äº JavaScript æ¸²æŸ“ï¼‰
- `DUPEFILTER_CLASS`: è‡ªå®šä¹‰å»é‡è¿‡æ»¤å™¨
- `REQUEST_FINGERPRINTER_IMPLEMENTATION`: è¯·æ±‚æŒ‡çº¹å®ç°ç‰ˆæœ¬

### Web åº”ç”¨é…ç½®

- é»˜è®¤ç«¯å£ï¼š5001
- æ•°æ®åº“è·¯å¾„ï¼šé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `stock_signals.db`

## æ³¨æ„äº‹é¡¹

1. **æ•°æ®æ–‡ä»¶**ï¼š`.gitignore` å·²é…ç½®å¿½ç•¥æ•°æ®æ–‡ä»¶ï¼ˆ`.csv`ã€`.db`ã€`kdj_signals_*.txt`ï¼‰ï¼Œè¿™äº›æ–‡ä»¶ä¸ä¼šæäº¤åˆ° Git
2. **API Key**ï¼šä½¿ç”¨è‚¡ç¥¨åˆ—è¡¨ API æ—¶éœ€è¦é…ç½® API Key
3. **Splash æœåŠ¡**ï¼šå¦‚æœä½¿ç”¨ `scrapy-splash`ï¼Œéœ€è¦å…ˆå¯åŠ¨ Splash æœåŠ¡
4. **æ•°æ®åº“è¿ç§»**ï¼šWeb åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼Œæ·»åŠ æ–°å­—æ®µ

## ç›¸å…³é“¾æ¥

- [GitHub ä»“åº“](https://github.com/bigpin/stocks_spiders)
- [é“¾å®¶çˆ¬è™«æ–‡ç« ](https://mp.weixin.qq.com/s?__biz=MjM5Mzg5NDQ2MA==&mid=2257483733&idx=1&sn=09b33c1e252ae568d8ce173d3fd21784)
- [ä¸œæ–¹è´¢å¯Œçˆ¬è™«æ–‡ç« ](https://mp.weixin.qq.com/s?__biz=MjM5Mzg5NDQ2MA==&mid=2257483733&idx=2&sn=2fdd627ce028b3b945c27658a0c1e06b)

## License

GPL-3.0

